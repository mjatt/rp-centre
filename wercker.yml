box: node

build:
  steps:
    - npm-install

    - script:
        name: lint
        code: npm run lint
    - script:
        name: build
        code: npm run build
deploy:
  steps:
    - add-to-known_hosts:
        hostname: rpcentre.bancey.xyz
    - mktemp:
      envvar: PRIVATEKEY_PATH
    - create-file:
      name: write key
      filename: $PRIVATEKEY_PATH
      content: $SSH_KEY
      overwrite: true
      hide-from-log: true
    - script:
        name: stop server
        code: ssh -i $PRIVATEKEY_PATH -o StrictHostKeyChecking=no -o UserKnownHostsFile=no -l bancey rpcentre.bancey.xyz sudo /home/bancey/scripts/stopServer.sh
    - script:
        name: update files
        code: |
              cd $WERCKER_SOURCE_DIR
              ls -la
              scp -i $PRIVATEKEY_PATH -o StrictHostKeyChecking=no -o UserKnownHostsFile=no rp-centre bancey@rpcentre.bancey.xyz:/home/bancey/
